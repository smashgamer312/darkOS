<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>darkOS Recovery</title>
<style>
    body {
        background: #000;
        color: #0f0;
        font-family: monospace;
        margin: 0;
        padding: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #terminal {
        width: 90%;
        height: 90%;
        background: #000;
        border: 2px solid #0f0;
        padding: 10px;
        overflow-y: auto;
        white-space: pre-wrap;
        box-sizing: border-box;
    }
    button {
        margin-top: 10px;
        background: #0f0;
        color: #000;
        border: none;
        padding: 5px 10px;
        font-family: monospace;
        cursor: pointer;
    }
</style>
</head>
<body>
<div id="terminal"></div>
<div style="position: fixed; bottom: 10px; left: 10px;">
    <button id="restoreCoreBtn">Восстановить core.js</button>
    <button id="restoreShellBtn">Восстановить shell.css</button>
</div>

<script>
const term = document.getElementById("terminal");

function log(text) {
    term.textContent += text + "\n";
    term.scrollTop = term.scrollHeight;
}

function fakeProcess(lines, callback) {
    let i = 0;
    const interval = setInterval(() => {
        log(lines[i]);
        i++;
        if (i >= lines.length) {
            clearInterval(interval);
            callback && callback();
        }
    }, 500); // задержка между строками
}

function fetchAndDownload(url, filename) {
    fetch(url)
        .then(res => {
            if (!res.ok) throw new Error("Ошибка загрузки");
            return res.blob();
        })
        .then(blob => {
            const a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = filename;
            a.click();
            URL.revokeObjectURL(a.href);
            log(filename + " успешно скачан!");
        })
        .catch(err => {
            log("Ошибка: " + err.message);
        });
}

function restoreCore() {
    fakeProcess([
        "=== darkOS Recovery ===",
        "Поиск core.js...",
        "Файл не найден",
        "Подключение к GitHub...",
        "Скачивание core.js...",
        "Проверка контрольной суммы...",
        "Подготовка к созданию файла..."
    ], () => {
        fetchAndDownload(
            "https://raw.githubusercontent.com/smashgamer312/darkOS/main/system/core.js",
            "core.js"
        );
    });
}

function restoreShell() {
    fakeProcess([
        "=== darkOS Recovery ===",
        "Поиск shell.css...",
        "Файл не найден",
        "Подключение к GitHub...",
        "Скачивание shell.css...",
        "Проверка контрольной суммы...",
        "Создание файла..."
    ], () => {
        fetchAndDownload(
            "https://raw.githubusercontent.com/smashgamer312/darkOS/main/system/shell.css",
            "shell.css"
        );
    });
}

document.getElementById("restoreCoreBtn").addEventListener("click", restoreCore);
document.getElementById("restoreShellBtn").addEventListener("click", restoreShell);
</script>
</body>
</html>

